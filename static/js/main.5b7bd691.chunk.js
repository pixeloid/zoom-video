(this["webpackJsonpreact-video-sdk-demo"]=this["webpackJsonpreact-video-sdk-demo"]||[]).push([[0],{144:function(e,t,n){},146:function(e,t,n){},149:function(e,t,n){},150:function(e,t,n){},151:function(e,t,n){},152:function(e,t,n){},154:function(e,t,n){},156:function(e,t,n){},161:function(e,t,n){},162:function(e,t,n){},163:function(e,t,n){},164:function(e,t,n){},165:function(e,t,n){},166:function(e,t,n){},170:function(e,t,n){"use strict";n.r(t);var c=n(0),a=n.n(c),r=n(23),i=n.n(r),s=n(75),o=n.n(s),u=(n(144),n(43)),l=n(27),d=n.n(l),f=n(41),h=n(14),j=n(113),b=n(22),v=n(114),O=n(175),m=(n(145),n(90)),p=n(172),g=n(177),x=Object(g.a)({scriptUrl:["//at.alicdn.com/t/font_2183897_b5xllwmo50n.js"]}),S=(n(146),n(5)),k=p.a.Meta,y=function(e){var t=e.history;return Object(S.jsxs)("div",{children:[Object(S.jsxs)("div",{className:"flex fixed nav",children:[Object(S.jsxs)("a",{href:"/",className:"h-full flex items-center router-active navhome",children:[Object(S.jsx)("img",{src:"./logo.svg",alt:"Home",className:"h-20px"}),Object(S.jsx)("span",{className:"text-second pl-4 ml-4 border-l border-line weak-hidden sm:inline-block",children:"VideoSDK"})]}),Object(S.jsx)("a",{href:"https://marketplace.zoom.us/docs/sdk/video/web/reference",className:"h-full flex items-center router-active navdoc",target:"_blank",rel:"noreferrer",children:Object(S.jsx)("span",{className:"text-second pl-4 ml-4 border-l border-line weak-hidden sm:inline-block",children:"API Reference"})}),Object(S.jsx)("a",{href:"https://marketplace.zoom.us/docs/sdk/video/web/essential",className:"h-full flex items-center router-active navdoc",target:"_blank",rel:"noreferrer",children:Object(S.jsx)("span",{className:"text-second pl-4 ml-4 border-l border-line weak-hidden sm:inline-block",children:"Doc"})})]}),Object(S.jsxs)("div",{className:"home",children:[Object(S.jsx)("h1",{children:"Zoom Video SDK feature"}),Object(S.jsx)("div",{className:"feature-entry",children:[{key:"video",icon:"icon-meeting",title:"Audio, video and share",description:"Gallery Layout, Start/Stop Audio, Mute/Unmute, Start/Stop Video, Start/Stop Screen Share"},{key:"chat",icon:"icon-chat",title:"Session chat",description:"Session Chat, Chat Priviledge"}].map((function(e){var n=e.key,c=e.icon,a=e.title,r=e.description;return Object(S.jsx)(p.a,{cover:Object(S.jsx)(x,{style:{fontSize:"72px"},type:c}),hoverable:!0,style:{width:320},className:"entry-item",onClick:function(){return e=n,void t.push("/".concat(e).concat(location.search));var e},children:Object(S.jsx)(k,{title:a,description:r})},n)}))})]})]})},C=n(4),w=n.n(C),N=a.a.createContext(null),I=a.a.createContext(null),E=n(180),A=(n(149),function(e){var t=e.participant,n=e.style,c=e.isActive,a=t.displayName,r=t.audio,i=t.muted,s=t.bVideoOn;return Object(S.jsxs)("div",{className:w()("avatar",{"avatar-active":c}),style:Object(u.a)(Object(u.a)({},n),{},{background:s?"transparent":"rgb(26,26,26)"}),children:[(s||"computer"===r&&i)&&Object(S.jsxs)("div",{className:"corner-name",children:["computer"===r&&i&&Object(S.jsx)(E.a,{style:{color:"#f00"}}),s&&Object(S.jsx)("span",{children:a})]}),!s&&Object(S.jsx)("p",{className:"center-name",children:a})]})}),M=n(117),P=n(37),R=n(181),U=n(182),V=(n(150),function(e){var t=e.isStartedVideo,n=e.onCameraClick,c=e.className;return Object(S.jsx)(M.a,{title:"".concat(t?"stop camera":"start camera"),children:Object(S.jsx)(P.a,{className:w()("camere-button",c),icon:t?Object(S.jsx)(R.a,{}):Object(S.jsx)(U.a,{}),ghost:!0,shape:"circle",size:"large",onClick:n})})}),H=n(183),z=(n(151),function(e){var t=e.isStartedAudio,n=e.isMuted,c=e.onMicrophoneClick,a=e.className,r=t?n?"unmute":"mute":"start audio";return Object(S.jsx)(M.a,{title:r,children:Object(S.jsx)(P.a,{className:w()("microphone-button",a),icon:t?n?Object(S.jsx)(E.a,{}):Object(S.jsx)(H.a,{}):Object(S.jsx)(x,{type:"icon-headset"}),ghost:!0,shape:"circle",size:"large",onClick:c})})}),D=(n(152),function(e){var t=e.isStartedScreenShare,n=e.onScreenShareClick;return Object(S.jsx)(M.a,{title:t?"stop screen share":"start screen share",children:Object(S.jsx)(P.a,{className:w()("screen-share-button",{"started-share":t}),icon:Object(S.jsx)(x,{type:"icon-share"}),ghost:!0,shape:"circle",size:"large",onClick:n})})});function T(e){var t=Object(c.useRef)(null);return Object(c.useEffect)((function(){t.current=e}),[e]),t.current}function J(e){var t=Object(c.useRef)(e);t.current=e,Object(c.useEffect)((function(){return function(){t.current&&t.current()}}),[])}function K(e){Object(c.useEffect)((function(){e()}),[])}var W=n(88),F=n.n(W);n(154);var L=function(e){var t=e.className,n=e.shareRef,a=e.sharing,r=Object(c.useState)(!1),i=Object(h.a)(r,2),s=i[0],o=i[1],u=Object(c.useState)(!1),l=Object(h.a)(u,2),j=l[0],b=l[1],O=Object(c.useState)(!1),m=Object(h.a)(O,2),p=m[0],g=m[1],x=Object(c.useState)(!0),k=Object(h.a)(x,2),y=k[0],C=k[1],E=Object(c.useContext)(I).mediaStream,A=Object(c.useContext)(N),M=Object(c.useCallback)(Object(f.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!j){e.next=6;break}return e.next=3,null===E||void 0===E?void 0:E.stopVideo();case 3:b(!1),e.next=9;break;case 6:return e.next=8,null===E||void 0===E?void 0:E.startVideo();case 8:b(!0);case 9:case"end":return e.stop()}}),e)}))),[E,j]),P=Object(c.useCallback)(Object(f.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!s){e.next=12;break}if(!y){e.next=7;break}return e.next=4,null===E||void 0===E?void 0:E.unmuteAudio();case 4:C(!1),e.next=10;break;case 7:return e.next=9,null===E||void 0===E?void 0:E.muteAudio();case 9:C(!0);case 10:e.next=15;break;case 12:return e.next=14,null===E||void 0===E?void 0:E.startAudio();case 14:o(!0);case 15:case"end":return e.stop()}}),e)}))),[E,s,y]),R=Object(c.useCallback)((function(e){var t=e.action,n=e.source,c=e.type;"join"===t&&"computer"===c?o(!0):"leave"===t?o(!1):"muted"===t?(C(!0),"passive(mute one)"===n&&v.b.info("Host muted you")):"unmuted"===t&&(C(!1),"passive"===n&&v.b.info("Host unmuted you"))}),[]),U=Object(c.useCallback)(Object(f.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p||!n||!n.current){e.next=6;break}return e.next=3,null===E||void 0===E?void 0:E.startShareScreen(n.current);case 3:g(!0),e.next=10;break;case 6:if(!p){e.next=10;break}return e.next=9,null===E||void 0===E?void 0:E.stopShareScreen();case 9:g(!1);case 10:case"end":return e.stop()}}),e)}))),[E,p,n]),H=Object(c.useCallback)((function(e){var t=e.reason;console.log("passively stop reason:",t),g(!1)}),[]);return Object(c.useEffect)((function(){return A.on("current-audio-change",R),A.on("passively-stop-share",H),function(){A.off("current-audio-change",R),A.off("passively-stop-share",H)}}),[A,R,H]),J((function(){s&&(null===E||void 0===E||E.stopAudio()),j&&(null===E||void 0===E||E.stopVideo()),p&&(null===E||void 0===E||E.stopShareScreen())})),Object(S.jsxs)("div",{className:w()("video-footer",t),children:[Object(S.jsx)(z,{isStartedAudio:s,isMuted:y,onMicrophoneClick:P}),Object(S.jsx)(V,{isStartedVideo:j,onCameraClick:M}),a&&Object(S.jsx)(D,{isStartedScreenShare:p,onScreenShareClick:U})]})},G=n(184),_=n(185),B=(n(156),function(e){var t=e.page,n=e.totalPage,a=e.setPage,r=e.inSharing,i="".concat(t+1,"/").concat(n),s=Object(c.useCallback)((function(){t>0&&a(t-1)}),[t,a]),o=Object(c.useCallback)((function(){t<n-1&&a(t+1)}),[t,n,a]);return Object(S.jsxs)("div",{className:w()("pagination",{"in-sharing":r}),children:[Object(S.jsx)(P.a,{className:"previous-page-button",icon:Object(S.jsx)(G.a,{}),ghost:!0,onClick:s,children:i},"left"),Object(S.jsx)(P.a,{className:"next-page-button",icon:Object(S.jsx)(_.a,{}),ghost:!0,onClick:o,children:i},"right")]})});function q(e,t){var n,a,r=Object(c.useState)({width:0,height:0}),i=Object(h.a)(r,2),s=i[0],o=i[1],u=Object(c.useCallback)((function(e){var n=e.width,c=e.height;t&&F.a.debounce((function(){o({width:arguments.length<=0?void 0:arguments[0],height:arguments.length<=1?void 0:arguments[1]})}),300).call(null,n,c)}),[t]);return n=t.current,a=u,Object(c.useLayoutEffect)((function(){if(!n)return function(){};var e=new ResizeObserver((function(e){e.forEach((function(e){a({width:e.target.clientWidth,height:e.target.clientHeight})}))}));return e.observe(n),function(){e.unobserve(n),e.disconnect()}}),[n,a]),K((function(){if(t.current){var e=t.current.getBoundingClientRect(),n=e.width,c=e.height;o({width:n,height:c})}})),Object(c.useEffect)((function(){var n=s.width,c=s.height;try{t.current&&(t.current.width=n,t.current.height=c)}catch(a){null===e||void 0===e||e.updateVideoCanvasDimension(t.current,n,c)}}),[e,s,t]),s}var X=n(76),Z=n(103),Q=Array.from({length:9}).map((function(e,t){var n=t+1,c=Math.ceil(n/2),a=Array.from({length:c}).map((function(e,t){var c=t+1,a=Math.ceil(n/c);return c<a?[{row:c,column:a},{row:a,column:c}]:c===a?[{row:c,column:a}]:[]})).reduce((function(e,t){return[].concat(Object(Z.a)(e),Object(Z.a)(t))}),[]);return{count:n,candidates:a}})).reduce((function(e,t){return Object(u.a)(Object(u.a)({},e),{},Object(X.a)({},t.count,t.candidates))}),{}),Y=0,$=1,ee=2,te=function(e,t){return{maxColumns:Math.max(1,Math.floor(e/266)),maxRows:Math.max(1,Math.floor(t/154))}};var ne=n(112);function ce(e,t,n,a,r,i){var s=T(r),o=T(a),u=T(i),l=T(t);Object(c.useEffect)((function(){if(n.current&&a&&a.length>0&&t){var c=r.filter((function(e){return!(s||[]).includes(e)})),l=(s||[]).filter((function(e){return!r.includes(e)})),h=r.filter((function(e){return(s||[]).includes(e)}));if(l.length>0&&l.forEach(function(){var t=Object(f.a)(d.a.mark((function t(c){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null===e||void 0===e?void 0:e.stopRenderVideo(n.current,c);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),c.length>0&&c.forEach(function(){var t=Object(f.a)(d.a.mark((function t(c){var r,s,o,u,l,f,h;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=i.findIndex((function(e){return e.userId===c})),!(s=a[r])){t.next=6;break}return o=s.width,u=s.height,l=s.x,f=s.y,h=s.quality,t.next=6,null===e||void 0===e?void 0:e.renderVideo(n.current,c,o,u,l,f,h);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),h.length>0){!o||a.length===o.length&&function(e,t){if(e===t)return!0;if(!e||!t)return!1;var n=Object.keys(e),c=Object.keys(t),a=n.length;if(c.length!==a)return!1;for(var r=0;r<a;r++){var i=n[r];if(e[i]!==t[i]||!Object.prototype.hasOwnProperty.call(t,i))return!1}return!0}(a[0],o[0])||h.forEach((function(t){var c=i.findIndex((function(e){return e.userId===t})),r=a[c];if(r){var s=r.width,o=r.height,u=r.x,l=r.y;null===e||void 0===e||e.adjustRenderedVideoPosition(n.current,t,s,o,u,l)}}));var j=i.map((function(e){return e.userId})),b=null===u||void 0===u?void 0:u.map((function(e){return e.userId}));j.join("-")!==(null===b||void 0===b?void 0:b.join("-"))&&h.forEach((function(t){var c=j.findIndex((function(e){return e===t}));if(c!==(null===b||void 0===b?void 0:b.findIndex((function(e){return e===t})))){var r=a[c];if(r){var i=r.width,s=r.height,o=r.x,u=r.y;null===e||void 0===e||e.adjustRenderedVideoPosition(n.current,t,i,s,o,u)}}}))}}}),[e,t,n,a,o,i,u,r,s]),Object(c.useEffect)((function(){!1===l&&!0===t&&r.length>0&&r.forEach(function(){var t=Object(f.a)(d.a.mark((function t(c){var r,s,o,u,l,f,h;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=i.findIndex((function(e){return e.userId===c})),!(s=a[r])){t.next=6;break}return o=s.width,u=s.height,l=s.x,f=s.y,h=s.quality,t.next=6,null===e||void 0===e?void 0:e.renderVideo(n.current,c,o,u,l,f,h);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}),[e,n,a,i,r,t,l]);var h=function(e){var t=Object(c.useRef)(e);t.current=e;var n=Object(c.useRef)();return n.current||(n.current=function(){for(var e=arguments.length,n=new Array(e),c=0;c<e;c++)n[c]=arguments[c];return t.current.apply(this,n)}),n.current}((function(t){r.length>0&&r.forEach((function(n){null===e||void 0===e||e.stopRenderVideo(t,n)}))}));Object(c.useEffect)((function(){var e=n.current;return function(){h(e)}}),[n,h])}function ae(e,t,n,a,r,i){var s=Object(c.useState)([]),o=Object(h.a)(s,2),u=o[0],l=o[1],d=Object(c.useState)([]),f=Object(h.a)(d,2),j=f[0],b=f[1],v=Object(c.useState)([]),O=Object(h.a)(v,2),m=O[0],p=O[1],g=i.page,x=i.pageSize,S=i.totalPage,k=i.totalSize,y=x;g===S-1&&(y=Math.min(y,k%x||y)),Object(c.useEffect)((function(){b(function(e,t,n){if(n>9||0===n)return[];var c=te(e,t),a=c.maxRows,r=c.maxColumns;a=Math.min(a,n),r=Math.min(r,n);var i=Math.min(n,a*r),s=Q[i].filter((function(e){return e.row<=a&&e.column<=r})).map((function(n){var c=n.column,a=n.row,r=Math.floor(Math.min(e/(16*c),t/(9*a))),i=16*r-10,s=9*r-10;return{cellWidth:i,cellHeight:s,cellArea:i*s,column:c,row:a}})).reduce((function(e,t){return t.cellArea>e.cellArea?t:e}),{cellArea:0,cellHeight:0,cellWidth:0,column:0,row:0}),o=s.cellWidth,u=s.cellHeight,l=s.column,d=s.row,f=o+10,h=u+10,j=(e-f*l)/2+5,b=(t-h*d)/2+5,v=[],O=(e-f*(l-l*d%i))/2+5,m=Y;i<=4&&u>=270?m=ee:i>4&&u>=180&&(m=$);for(var p=0;p<d;p++)for(var g=0;g<l;g++){var x=p!==d-1?j:O;p*l+g<i&&v.push({width:o,height:u,x:Math.floor(x+g*f),y:Math.floor(b+(d-p-1)*h),quality:m})}return v}(r.width,r.height,y))}),[r,y]);var C=Object(c.useCallback)((function(){var t=e.getAllUser(),n=e.getCurrentUserInfo();if(n&&t.length>0){var c=[];1===t.length?c=t:((c=t.filter((function(e){return e.userId!==n.userId})).sort((function(e,t){return Number(t.bVideoOn)-Number(e.bVideoOn)}))).splice(1,0,n),c=c.filter((function(e,t){return Math.floor(t/x)===g}))),l(c);var a=c.filter((function(e){return e.bVideoOn})).map((function(e){return e.userId}));p(a)}}),[e,g,x]);return Object(c.useEffect)((function(){return e.on("user-added",C),e.on("user-removed",C),e.on("user-updated",C),function(){e.off("user-added",C),e.off("user-removed",C),e.off("user-updated",C)}}),[e,C]),Object(c.useEffect)((function(){C()}),[C]),ce(t,n,a,j,m,u),{visibleParticipants:u,layout:j}}function re(e,t){var n=Object(c.useState)(0),a=Object(h.a)(n,2),r=a[0],i=a[1],s=Object(c.useState)(0),o=Object(h.a)(s,2),u=o[0],l=o[1],d=Object(c.useState)(9),f=Object(h.a)(d,2),j=f[0],b=f[1];Object(c.useEffect)((function(){var e=Math.min(9,function(e,t){var n=te(e,t);return n.maxRows*n.maxColumns}(t.width,t.height));b(e)}),[t]);var v=Object(c.useCallback)((function(){l(e.getAllUser().length)}),[e]);return Object(c.useEffect)((function(){return e.on("user-added",v),e.on("user-removed",v),e.on("user-updated",v),function(){e.off("user-added",v),e.off("user-removed",v),e.off("user-updated",v)}}),[e,v]),K((function(){l(e.getAllUser().length)})),{page:r,totalPage:Math.ceil(u/j),pageSize:j,totalSize:u,setPage:i}}n(161);var ie=function(e){var t=Object(c.useContext)(N),n=Object(c.useContext)(I),a=n.mediaStream,r=n.video.decode,i=Object(c.useRef)(null),s=Object(c.useRef)(null),o=Object(c.useRef)(null),u=Object(c.useRef)(null),l=q(a,i),d=function(e){var t=Object(c.useState)(0),n=Object(h.a)(t,2),a=n[0],r=n[1],i=Object(c.useState)(0),s=Object(h.a)(i,2),o=s[0],u=s[1],l=Object(c.useCallback)((function(e){var t=e.state,n=e.userId;"Active"===t?r(n):"Inactive"===t&&r(0)}),[]),d=Object(c.useCallback)((function(e){if(Array.isArray(e)&&e.length>0){var t=e[0].userId;u(t)}}),[]);return Object(c.useEffect)((function(){return e.on("video-active-change",l),e.on("active-speaker",d),function(){e.off("video-active-change",l),e.off("active-speaker",d)}}),[e,l,d]),a||o}(t),f=re(t,l),j=f.page,b=f.pageSize,v=f.totalPage,O=f.totalSize,m=f.setPage,p=ae(t,a,r,i,l,{page:j,pageSize:b,totalPage:v,totalSize:O}),g=p.visibleParticipants,x=p.layout,k=function(e,t,n){var a=Object(c.useState)(!1),r=Object(h.a)(a,2),i=r[0],s=r[1],o=Object(c.useState)(!1),u=Object(h.a)(o,2),l=u[0],d=u[1],f=Object(c.useState)(0),j=Object(h.a)(f,2),b=j[0],v=j[1],O=Object(c.useState)({width:0,height:0}),m=Object(h.a)(O,2),p=m[0],g=m[1],x=Object(c.useState)(0),S=Object(h.a)(x,2),k=S[0],y=S[1],C=Object(c.useCallback)((function(e){var t=e.state,n=e.userId;l||(v(n),s("Active"===t))}),[l]),w=Object(c.useCallback)((function(e){var t=e.width,n=e.height;g({width:t,height:n})}),[]),N=Object(c.useCallback)((function(e){Array.isArray(e)&&e.length>0&&e.forEach((function(e){e.userId===k&&void 0!==e.sharerOn&&(d(e.sharerOn),e.sharerOn&&s(!1))}))}),[k]);Object(c.useEffect)((function(){return e.on("active-share-change",C),e.on("share-content-dimension-change",w),e.on("user-updated",N),function(){e.off("active-share-change",C),e.off("share-content-dimension-change",w),e.off("user-updated",N)}}),[e,C,w,N]);var I=T(i);return Object(c.useEffect)((function(){n.current&&I!==i&&(i?null===t||void 0===t||t.startShareView(n.current,b):!0===I&&!1===i&&(null===t||void 0===t||t.stopShareView()))}),[t,n,I,i,b]),Object(c.useEffect)((function(){if(t){var e=t.getActiveShareUserId();e&&(s(!0),v(e))}}),[t]),K((function(){var t=e.getCurrentUserInfo();t&&y(t.userId)})),J((function(){i&&(null===t||void 0===t||t.stopShareView())})),{isRecieveSharing:i,isStartedShare:l,sharedContentDimension:p}}(t,a,s),y=k.isRecieveSharing,C=k.isStartedShare,E=k.sharedContentDimension,M=y||C,P=E;if(M&&u.current){var R=E.width,U=E.height,V=u.current.getBoundingClientRect(),H=V.width,z=V.height,D=Math.min(H/R,z/U,1);P.width=Math.floor(R*D),P.height=Math.floor(U*D)}return Object(S.jsxs)("div",{className:"viewport",children:[Object(S.jsx)("div",{className:w()("share-container",{"in-sharing":M}),ref:u,children:Object(S.jsxs)("div",{className:"share-container-viewport",style:{width:"".concat(P.width,"px"),height:"".concat(P.height,"px")},children:[Object(S.jsx)("canvas",{className:w()("share-canvas",{hidden:C}),ref:s}),Object(S.jsx)("canvas",{className:w()("share-canvas",{hidden:y}),ref:o})]})}),Object(S.jsxs)("div",{className:w()("video-container",{"in-sharing":M}),children:[Object(S.jsx)("canvas",{className:"video-canvas",id:"video-canvas",width:"800",height:"600",ref:i}),Object(S.jsx)("ul",{className:"avatar-list",children:g.map((function(e,t){if(t>x.length-1)return null;var n=x[t],c=n.width,a=n.height,r=n.x,i=n.y,s=l.height;return Object(S.jsx)(A,{participant:e,isActive:d===e.userId,style:{width:"".concat(c,"px"),height:"".concat(a,"px"),top:"".concat(s-i-a,"px"),left:"".concat(r,"px")}},e.userId)}))})]}),Object(S.jsx)(L,{className:"video-operations",sharing:!0,shareRef:o}),v>1&&Object(S.jsx)(B,{page:j,totalPage:v,setPage:m,inSharing:M})]})},se=a.a.createContext(null),oe=n(72),ue=(n(162),function(e){var t=e.content;return Object(S.jsxs)("div",{className:"loading-layer",children:[Object(S.jsx)(oe.a,{style:{fontSize:"86px",color:"#fff"}}),Object(S.jsx)("p",{className:"loading-text",children:t})]})}),le=n(173);var de,fe=n(186),he=(n(163),function(e){var t=e.record,n=e.currentUserId,a=e.setChatUser,r=t.message,i=t.sender,s=t.receiver,o=t.timestamp,u=i.avatar,l=n===i.userId,d=Object(c.useCallback)((function(){l||a(i.userId)}),[l,i,a]),f=Array.isArray(r)?r:[r];return Object(S.jsxs)("div",{className:w()("chat-message-item",{myself:l}),children:[Object(S.jsx)(P.a,{className:"chat-message-avatar",onClick:d,ghost:!0,shape:"circle",size:"large",children:u?Object(S.jsx)("img",{src:u,className:"chat-message-avatar-img",alt:""}):Object(S.jsx)(fe.a,{})}),Object(S.jsxs)("div",{className:"chat-message-content",children:[Object(S.jsxs)("div",{className:w()("chat-message-info",{myself:l}),children:[Object(S.jsxs)("p",{className:"chat-message-receiver",children:[l?"":i.name,Object(S.jsx)("span",{children:"To"}),Object(S.jsx)("a",{href:"#",onClick:function(e){e.preventDefault(),a(s.userId)},children:s.userId===n?"me":s.name})]}),Object(S.jsx)("p",{className:"chat-message-time",children:new Date(o).toLocaleTimeString()})]}),Object(S.jsx)("ul",{className:w()("chat-message-text-list",{myself:l}),children:f.map((function(e,t){return Object(S.jsx)("li",{className:w()("chat-message-text"),children:e},t)}))})]})]})}),je=n(174),be=n(176),ve=n(178),Oe=n(179),me=n(187);!function(e){e[e.All=1]="All",e[e.NoOne=4]="NoOne",e[e.EveryonePublicly=5]="EveryonePublicly"}(de||(de={}));n(164);var pe=je.a.Item,ge=je.a.ItemGroup,xe=[{name:"No One",value:de.NoOne},{name:"Everyone Publicly",value:de.EveryonePublicly},{name:"Everyone Publicly and Directly",value:de.All}],Se=function(e){var t=e.chatUsers,n=e.selectedChatUser,a=e.chatPrivilege,r=e.isHostOrManager,i=e.setChatUser,s=Object(c.useContext)(se),o=t.map((function(e){return Object(S.jsxs)(pe,{className:w()("chat-receiver-item",{selected:e.userId===(null===n||void 0===n?void 0:n.userId)}),icon:e.userId===(null===n||void 0===n?void 0:n.userId)&&Object(S.jsx)(ve.a,{}),children:[e.displayName,(e.isCoHost||e.isHost)&&Object(S.jsxs)("span",{className:"chat-receiver-item-affix",children:["(",e.isHost?"Host":"Co-host",")"]})]},e.userId)})),u=Object(c.useCallback)((function(e){var t=e.key,c=Number(t);c!==(null===n||void 0===n?void 0:n.userId)&&i(c)}),[n,i]),l=Object(c.useCallback)((function(e){var t=e.key,n=Number(t);a!==n&&(null===s||void 0===s||s.setPrivilege(n))}),[a,s]),d=Object(S.jsx)(je.a,{onClick:u,className:"chat-receiver-dropdown-menu",children:o}),f=null;if(r){var h=xe.map((function(e){return Object(S.jsx)(pe,{className:w()("chat-privilege-item",{selected:e.value===a}),icon:e.value===a&&Object(S.jsx)(ve.a,{}),children:e.name},e.value)}));f=Object(S.jsx)(je.a,{onClick:l,className:"chat-receiver-dropdown-menu",children:Object(S.jsx)(ge,{title:"Participant Can Chat With:",children:h},"privilege")})}return Object(S.jsxs)("div",{className:"chat-receiver",children:[Object(S.jsxs)("div",{className:"chat-receiver-wrap",children:[Object(S.jsx)("span",{className:"chat-to",children:"To:"}),Object(S.jsx)(be.a,{overlay:d,placement:"topLeft",trigger:["click"],children:Object(S.jsxs)(P.a,{className:"chat-receiver-button",children:[null===n||void 0===n?void 0:n.displayName," ",Object(S.jsx)(Oe.a,{})]})})]}),r&&Object(S.jsx)(be.a,{overlay:f,placement:"topRight",trigger:["click"],children:Object(S.jsx)(P.a,{className:"chat-privilege-button",children:Object(S.jsx)(me.a,{})})})]})},ke=(n(165),le.a.TextArea),ye=function(){var e=Object(c.useContext)(N),t=Object(c.useContext)(se),n=Object(c.useState)([]),a=Object(h.a)(n,2),r=a[0],i=a[1],s=Object(c.useState)(0),o=Object(h.a)(s,2),u=o[0],l=o[1],d=Object(c.useState)([]),f=Object(h.a)(d,2),j=f[0],b=f[1],v=Object(c.useState)(de.All),O=Object(h.a)(v,2),p=O[0],g=O[1],x=Object(c.useState)(null),k=Object(h.a)(x,2),y=k[0],C=k[1],w=Object(c.useState)(!1),I=Object(h.a)(w,2),E=I[0],A=I[1],M=Object(c.useState)(!1),P=Object(h.a)(M,2),R=P[0],U=P[1],V=Object(c.useState)(""),H=Object(h.a)(V,2),z=H[0],D=H[1],T=Object(c.useRef)(null),J=Object(c.useCallback)((function(e){i(Object(m.a)((function(t){var n=t.length;if(n>0){var c=t[n-1];e.sender.userId===c.sender.userId&&e.receiver.userId===c.receiver.userId&&e.timestamp-c.timestamp<3e5?Array.isArray(c.message)?c.message.push(e.message):c.message=[c.message,e.message]:t.push(e)}else t.push(e)}))),T.current&&T.current.scrollTo(0,T.current.scrollHeight)}),[T]),W=Object(c.useCallback)((function(e){g(e.chatPrivilege),t&&b(t.getReceivers())}),[t]),F=Object(c.useCallback)((function(e){D(e.target.value)}),[]);Object(c.useEffect)((function(){return e.on("chat-on-message",J),function(){e.off("chat-on-message",J)}}),[e,J]),Object(c.useEffect)((function(){return e.on("chat-privilege-change",W),function(){e.off("chat-privilege-change",W)}}),[e,W]),function(e,t){var n=Object(c.useRef)(t);n.current=t;var a=Object(c.useCallback)((function(){var t=e.getAllUser();n.current&&n.current(t)}),[e]);Object(c.useEffect)((function(){return e.on("user-added",a),e.on("user-removed",a),e.on("user-updated",a),function(){e.off("user-added",a),e.off("user-removed",a),e.off("user-updated",a)}}),[e,a]),K((function(){a()}))}(e,(function(){t&&b(t.getReceivers()),A(e.isHost()),U(e.isManager())})),Object(c.useEffect)((function(){y?-1===j.findIndex((function(e){return e.userId===y.userId}))&&C(j[0]):j.length>0&&C(j[0])}),[j,y]);var L=Object(c.useCallback)((function(e){var t=j.find((function(t){return t.userId===e}));t&&C(t)}),[j]),G=Object(c.useCallback)((function(e){e.preventDefault(),y&&z&&(null===t||void 0===t||t.send(z,null===y||void 0===y?void 0:y.userId),D(""))}),[t,z,y]);return K((function(){l(e.getSessionInfo().userId),t&&g(t.getPrivilege())})),Object(S.jsx)("div",{className:"chat-container",children:Object(S.jsxs)("div",{className:"chat-wrap",children:[Object(S.jsx)("h2",{children:"Chat"}),Object(S.jsx)("div",{className:"chat-message-wrap",ref:T,children:r.map((function(e){return Object(S.jsx)(he,{record:e,currentUserId:u,setChatUser:L},e.timestamp)}))}),de.NoOne!==p||E||R?Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(Se,{chatUsers:j,selectedChatUser:y,isHostOrManager:E||R,chatPrivilege:p,setChatUser:L}),Object(S.jsx)("div",{className:"chat-message-box",children:Object(S.jsx)(ke,{onPressEnter:G,onChange:F,value:z,placeholder:"Type message here ..."})})]}):Object(S.jsx)("div",{className:"chat-disabled",children:"Chat disabled"})]})})},Ce=(n(166),{audio:{encode:!1,decode:!1},video:{encode:!1,decode:!1},share:{encode:!1,decode:!1}}),we=Object(m.a)((function(e,t){switch(t.type){case"audio-encode":e.audio.encode=t.payload;break;case"audio-decode":e.audio.decode=t.payload;break;case"video-encode":e.video.encode=t.payload;break;case"video-decode":e.video.decode=t.payload;break;case"share-encode":e.share.encode=t.payload;break;case"share-decode":e.share.decode=t.payload}}),Ce);var Ne=function(e){var t=e.meetingArgs,n=t.sdkKey,a=t.topic,r=t.signature,i=t.name,s=t.password,l=Object(c.useState)(!0),m=Object(h.a)(l,2),p=m[0],g=m[1],x=Object(c.useState)(""),k=Object(h.a)(x,2),C=k[0],w=k[1],E=Object(c.useState)(!1),A=Object(h.a)(E,2),M=A[0],P=A[1],R=Object(c.useReducer)(we,Ce),U=Object(h.a)(R,2),V=U[0],H=U[1],z=Object(c.useState)(null),D=Object(h.a)(z,2),T=D[0],J=D[1],K=Object(c.useState)(null),W=Object(h.a)(K,2),F=W[0],L=W[1],G=Object(c.useContext)(N);Object(c.useEffect)((function(){return function(){var e=Object(f.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G.init("en-US","".concat(window.location.origin,"/lib"));case 2:return e.prev=2,w("Joining the session..."),e.next=6,G.join(a,r,i,s);case 6:J(G.getMediaStream()),t=G.getChatClient(),L(t),g(!1),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(2),g(!1),v.b.error(e.t0.reason);case 16:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(){return e.apply(this,arguments)}}()(),function(){o.a.destroyClient()}}),[n,r,G,a,i,s]);var _=Object(c.useCallback)((function(e){"Reconnecting"===e.state?(g(!0),P(!0),"failover"===e.reason&&w("Session Disconnected,Try to reconnect")):"Connected"===e.state&&M?g(!1):"Closed"===e.state&&O.a.warning({title:"Session ended",content:"This session has been ended by host"})}),[M]),B=Object(c.useCallback)((function(e){var t=e.action,n=e.type,c=e.result;H({type:"".concat(n,"-").concat(t),payload:"success"===c})}),[]);return Object(c.useEffect)((function(){return G.on("connection-change",_),G.on("media-sdk-change",B),function(){G.off("connection-change",_),G.off("media-sdk-change",B)}}),[G,_,B]),Object(S.jsxs)("div",{className:"App",children:[p&&Object(S.jsx)(ue,{content:C}),!p&&Object(S.jsx)(I.Provider,{value:Object(u.a)(Object(u.a)({},V),{},{mediaStream:T}),children:Object(S.jsx)(se.Provider,{value:F,children:Object(S.jsx)(j.a,{children:Object(S.jsxs)(b.c,{children:[Object(S.jsx)(b.a,{path:"/",component:y,exact:!0}),Object(S.jsx)(b.a,{path:"/video",component:ie}),Object(S.jsx)(b.a,{path:"/chat",component:ye})]})})})})]})},Ie=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,188)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),c(e),a(e),r(e),i(e)}))};var Ee={sdkKey:"EorjEyn25QvtiMgG5K2IH92k0f2Hu4fe5iuh",sdkSecret:"Cw6zibGco8Wcl0Gh7vwho5gaNsxEl25NOZhe",topic:"test topic",name:"".concat(function(){var e=navigator.userAgent;return e.indexOf("Opera")>-1||e.indexOf("OPR")>-1?"Opera":e.indexOf("compatible")>-1&&e.indexOf("MSIE")>-1?"IE":e.indexOf("Edge")>-1?"Edge":e.indexOf("Firefox")>-1?"Firefox":e.indexOf("Safari")>-1&&-1===e.indexOf("Chrome")?"Safari":e.indexOf("Chrome")>-1&&e.indexOf("Safari")>-1?"Chrome":window.ActiveXObject||"ActiveXObject"in window?"IE>=11":"Unkonwn"}(),"-").concat(Math.floor(1e3*Math.random())),password:"",signature:""},Ae=Object.fromEntries(new URLSearchParams(location.search));Ae.sdkKey&&Ae.topic&&Ae.name&&Ae.signature||(Ae=Ee),!Ae.signature&&Ae.sdkSecret&&Ae.topic&&(Ae.signature=function(e,t,n){var c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a="";try{var r=Math.round((new Date).getTime()/1e3),i={alg:"HS256",typ:"JWT"},s={app_key:e,iat:r,exp:r+7200,tpc:n,pwd:c},o=JSON.stringify(i),u=JSON.stringify(s);a=ne.KJUR.jws.JWS.sign("HS256",o,u,t)}catch(l){console.error(l)}return a}(Ae.sdkKey,Ae.sdkSecret,Ae.topic,Ae.password));var Me=o.a.createClient();i.a.render(Object(S.jsx)(a.a.StrictMode,{children:Object(S.jsx)(N.Provider,{value:Me,children:Object(S.jsx)(Ne,{meetingArgs:Ae})})}),document.getElementById("root")),Ie()}},[[170,1,2]]]);
//# sourceMappingURL=main.5b7bd691.chunk.js.map